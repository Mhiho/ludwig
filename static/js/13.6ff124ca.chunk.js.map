{"version":3,"sources":["styles/addBook.module.scss","components/AddBook/AddBookCover.js"],"names":["module","exports","AddBookCover","state","preview","id","sent","error","btnCt","redirect","book","file","imagePreviewUrl","addImg","event","preventDefault","url","adresse","headers","Authorization","getUser","token","console","log","formData","FormData","append","name","axios","post","then","res","setState","catch","goFurther","this","props","match","params","get","data","reader","FileReader","target","files","onloadend","result","readAsDataURL","to","style","color","width","height","onSubmit","e","className","classes","inptsContainer","fileAdd","inpt","accept","type","onChange","handleImageChange","fileSbmt","value","buttonContainer","onClick","classesRoot","typicalBtn","frameContainer","alt","src","coverUrl","Component"],"mappings":"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","file":"static/js/13.6ff124ca.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"Category\":\"addBook_Category__dlvdX\",\"categoriesContainer\":\"addBook_categoriesContainer__2Gkjs\",\"frameContainer\":\"addBook_frameContainer__oVIwQ\",\"fileAdd\":\"addBook_fileAdd__a2Xcg\",\"inptsContainer\":\"addBook_inptsContainer__2wgYG\",\"fileSbmt\":\"addBook_fileSbmt__1c8NE\",\"buttonContainer\":\"addBook_buttonContainer__2ol1t\",\"writingContainer\":\"addBook_writingContainer__2eQ8r\",\"newChapContainer\":\"addBook_newChapContainer__2ShKR\",\"delAkapit\":\"addBook_delAkapit__2jk60\",\"oneUp\":\"addBook_oneUp__xAl5_\",\"oneDown\":\"addBook_oneDown__M38nc\",\"BackgroundForBook\":\"addBook_BackgroundForBook__13gGK\"};","import React, { Component } from \"react\";\nimport { adresse } from \"../../config\";\nimport { getUser } from \"../../services/auth\";\nimport classes from \"../../styles/addBook.module.scss\";\nimport classesRoot from \"../../styles/index.module.scss\";\nimport axios from \"../../axiosInstance\";\nimport { Redirect } from \"react-router-dom\";\n\nclass AddBookCover extends Component {\n  state = {\n    preview: null,\n    id: \"\",\n    sent: false,\n    error: \"\",\n    btnCt: \"\",\n    redirect: false,\n    book: {},\n    file: null,\n    imagePreviewUrl: \"\",\n  };\n\n  componentDidMount() {\n    let { id } = this.props.match.params;\n    this.setState({ id: id });\n    const url = `${adresse}/books/${id}`;\n\n    const headers = {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + getUser().token,\n    };\n    axios\n      .get(url, {\n        headers: headers,\n      })\n      .then((res) => {\n        console.log(res.data);\n        this.setState({ book: res.data });\n      })\n      .catch(function (error) {\n        // handle error\n        console.log(error);\n      });\n  }\n\n  addImg = (event) => {\n    event.preventDefault();\n    const url = `${adresse}/books/mine/${this.state.id}/addCover`;\n    const headers = {\n      \"Content-Type\": \"multipart/form-data\",\n      Authorization: \"Bearer \" + getUser().token,\n    };\n    console.log(headers);\n    const formData = new FormData();\n    formData.append(\"image\", this.state.file, this.state.file.name);\n    axios\n      .post(url, formData, {\n        headers: headers,\n      })\n      .then((res) => {\n        // then print response status\n        this.setState({\n          sent: true,\n          error: \"\",\n        });\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({\n          sent: false,\n          error:\n            \"Coś poszło nie tak. Zdjęcie musi być w formacie png lub jpg i mieć nie więcej niż 1 Mb.\",\n        });\n      });\n  };\n\n  handleImageChange(event) {\n    event.preventDefault();\n\n    let reader = new FileReader();\n    let file = event.target.files[0];\n\n    reader.onloadend = () => {\n      this.setState({\n        file: file,\n        imagePreviewUrl: reader.result,\n      });\n    };\n\n    reader.readAsDataURL(file);\n  }\n  goFurther = () => {\n    if (this.state.sent === true) {\n      this.setState({ redirect: true });\n    } else {\n      this.setState({ error: \"Zdjęcie musi być dodane\" });\n    }\n  };\n\n  render() {\n    console.log(this.state.file);\n    if (this.state.redirect === true) {\n      return <Redirect to={`/myBooks/${this.state.id}/writing`} />;\n    }\n    return (\n      <div>\n        <div style={{ color: \"red\", width: \"100%\", height: \"50px\" }}>\n          {this.state.error}\n        </div>\n        <form onSubmit={(e) => this.addImg(e)}>\n          <div className={classes.inptsContainer}>\n            <input\n              className={`${classes.fileAdd} ${classes.inpt}`}\n              name=\"image\"\n              accept=\"image/png, image/jpeg, image/jpg\"\n              type=\"file\"\n              onChange={(e) => this.handleImageChange(e)}\n            />\n\n            <input\n              className={`${classes.inpt} ${classes.fileSbmt}`}\n              type=\"submit\"\n              value=\"Prześlij\"\n            />\n          </div>\n        </form>\n        <div className={classes.buttonContainer}>\n          <button onClick={this.goFurther} className={classesRoot.typicalBtn}>\n            Chcę przejść do pisania!\n          </button>\n        </div>\n        <div className={classes.frameContainer}>\n          <img\n            alt=\"bookCover\"\n            src={\n              this.state.imagePreviewUrl !== \"\"\n                ? this.state.imagePreviewUrl\n                : `${adresse}/${this.state.book.coverUrl}`\n            }\n          />\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default AddBookCover;\n"],"sourceRoot":""}